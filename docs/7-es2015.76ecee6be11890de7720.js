(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{CRCv:function(t,e,r){"use strict";r.r(e),r.d(e,"EditorModule",function(){return D});var i=r("gy9y"),c=r("AxuA"),a=r("ofXK"),s=r("tyNb"),o=r("9jGm"),n=r("l7P3"),l=r("LRne"),d=r("zp1y"),b=r("bOdf"),u=r("lJxs"),p=r("JIr8"),h=r("A47K"),f=r("fXoL");let O=(()=>{class t{constructor(t){this.apiService=t}publishArticle(t){return t.slug?this.apiService.put("/articles/"+t.slug,{article:t}):this.apiService.post("/articles/",{article:t})}get(t){return this.apiService.get("/articles/"+t)}}return t.\u0275fac=function(e){return new(e||t)(f.Qb(h.b))},t.\u0275prov=f.Eb({token:t,factory:t.\u0275fac}),t})();const g=Object(n.n)("[editor] PUBLISH_ARTICLE"),m=Object(n.n)("[editor] INITIALIZE_ARTICLE"),v=Object(n.n)("[editor] LOAD_ARTICLE",Object(n.s)()),j=Object(n.n)("[editor] LOAD_ARTICLE_SUCCESS",Object(n.s)()),A=Object(n.n)("[editor] LOAD_ARTICLE_FAIL",Object(n.s)());var F=r("EdWO");let y=(()=>{class t{constructor(t,e,r){this.actions$=t,this.ngrxFormsFacade=e,this.editorService=r,this.publishArticle$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(g),Object(d.a)(this.ngrxFormsFacade.data$),Object(b.a)(([t,e])=>this.editorService.publishArticle(e).pipe(Object(u.a)(t=>Object(F.b)({to:{path:["article",t.article.slug]}})),Object(p.a)(t=>Object(l.a)(Object(c.d)({errors:t.error.errors}))))))),this.loadArticle$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(v),Object(b.a)(t=>this.editorService.get(t.id).pipe(Object(u.a)(t=>j({article:t.article})),Object(p.a)(t=>Object(l.a)(A(t)))))))}}return t.\u0275fac=function(e){return new(e||t)(f.Qb(o.a),f.Qb(c.a),f.Qb(O))},t.\u0275prov=f.Eb({token:t,factory:t.\u0275fac}),t})();const L={article:{slug:"",title:"",description:"",body:"",tagList:[],createdAt:"",updatedAt:"",favorited:!1,favoritesCount:0,author:{username:"",bio:"",image:"",following:!1,loading:!1}}},I=Object(n.p)(L,Object(n.r)(j,(t,e)=>Object.assign(Object.assign({},t),{article:e.article})),Object(n.r)(A,m,()=>L));function E(t,e){return I(t,e)}const $=Object(n.o)("editor"),S={getArticle:Object(n.q)($,t=>t.article)};let T=(()=>{class t{constructor(t){this.store=t,this.article$=this.store.select(S.getArticle)}loadArticle(t){this.store.dispatch(v({id:t}))}loadArticleSuccess(t){this.store.dispatch(j({article:t}))}loadArticleFail(t){this.store.dispatch(A({error:t}))}publishArticle(){this.store.dispatch(g())}initializeArticle(){this.store.dispatch(m())}}return t.\u0275fac=function(e){return new(e||t)(f.Qb(n.h))},t.\u0275prov=f.Eb({token:t,factory:t.\u0275fac}),t})();var w=r("3Pt+"),x=r("T7Fx"),C=r("5W4/");const R=[{type:"INPUT",name:"title",placeholder:"Article Title",validator:[w.h.required]},{type:"INPUT",name:"description",placeholder:"What's this article about?",validator:[w.h.required]},{type:"TEXTAREA",name:"body",placeholder:"Write your article (in markdown)",validator:[w.h.required]},{type:"INPUT",name:"tagList",placeholder:"Enter Tags",validator:[]}];let k=(()=>{class t{constructor(t,e,r){this.ngrxFormsFacade=t,this.router=e,this.facade=r}ngOnInit(){this.ngrxFormsFacade.setStructure(R),this.data$=this.ngrxFormsFacade.data$,this.structure$=this.ngrxFormsFacade.structure$,this.facade.article$.subscribe(t=>this.ngrxFormsFacade.setData(t))}updateForm(t){this.ngrxFormsFacade.updateData(t)}submit(){this.facade.publishArticle()}ngOnDestroy(){this.ngrxFormsFacade.initializeForm(),this.facade.initializeArticle()}}return t.\u0275fac=function(e){return new(e||t)(f.Ib(c.a),f.Ib(s.e),f.Ib(T))},t.\u0275cmp=f.Cb({type:t,selectors:[["app-article-editor"]],decls:8,vars:2,consts:[[1,"editor-page"],[1,"container","page"],[1,"row"],[1,"col-md-10","offset-md-1","col-xs-12"],[3,"data$","structure$","updateForm"],["type","button",1,"btn","btn-lg","pull-xs-right","btn-primary",3,"click"]],template:function(t,e){1&t&&(f.Mb(0,"div",0),f.Mb(1,"div",1),f.Mb(2,"div",2),f.Mb(3,"div",3),f.Jb(4,"app-list-errors"),f.Mb(5,"app-dynamic-form",4),f.Tb("updateForm",function(t){return e.updateForm(t)}),f.Lb(),f.Mb(6,"button",5),f.Tb("click",function(){return e.submit()}),f.jc(7," Publish Article "),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb()),2&t&&(f.yb(5),f.Zb("data$",e.data$)("structure$",e.structure$))},directives:[x.a,C.a],styles:[""],changeDetection:0}),t})(),M=(()=>{class t{constructor(t){this.facade=t}resolve(t,e){const r=t.params.slug;return r&&this.facade.loadArticle(r),Object(l.a)(!0)}}return t.\u0275fac=function(e){return new(e||t)(f.Qb(T))},t.\u0275prov=f.Eb({token:t,factory:t.\u0275fac}),t})(),D=(()=>{class t{}return t.\u0275mod=f.Gb({type:t}),t.\u0275inj=f.Fb({factory:function(e){return new(e||t)},providers:[y,O,M,T],imports:[[a.c,c.b,s.h.forChild([{path:"",pathMatch:"full",component:k,resolve:{EditorResolverService:M},canActivate:[i.b]},{path:":slug",component:k,resolve:{EditorResolverService:M}}]),n.j.forFeature("editor",E,{initialState:L}),o.b.forFeature([y])]]}),t})()}}]);